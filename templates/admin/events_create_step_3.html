<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Events</title>
  <!-- Подключение Bootstrap CSS -->
  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Instrument+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <!-- Подключение Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
  <link rel="stylesheet" href="/static/css/style_events.css" />
</head>
<body>
  <div class="et-desktop-event-create">
    {% include 'admin/sidebar.html' %}
    <form method="POST" action="/admin/events/create" enctype="multipart/form-data">
      <input type="hidden" name="step" value="step_3">

      <div class="et-column5">
        <div class="et-row-view9">
          <button
            type="button"
            style="background:none;border:none;padding:0;margin:0;cursor:pointer;outline:none;"
            onclick="window.location.href='/admin/events/cancel'"
            aria-label="Назад"
          >
            <img src="/static/images/sidebar/left.svg" alt="Back" draggable="false" style="display:block;" />
          </button>
          <span class="text6">Create new event</span>
        </div>

        <div class="et-column6">
          <div class="et-column7">
            <span class="ec-text7" style="font-family: Instrument Sans, sans-serif;">Add tickets</span>

            <div class="et-column8">
              <div class="et-row-view10">
                <div class="et-input-block">
                  <label class="ec-text8" for="available-quantity-name">Available quantity</label>
                  <div class="et-input-row-2">
                    <input
                      class="ec-input-field"
                      id="available-quantity-name"
                      name="available_quantity"
                      type="number"
                      min="1"
                      placeholder="Enter quantity"
                      autocomplete="off"
                    />
                    <div class="et-input-info">
<!--                      <img src="/static/images/sidebar/CalendarBlank.svg" class="et-input-calendar" alt="calendar"/>-->
                    </div>
                  </div>
                </div>

                <div class="et-input-block">
                  <label class="ec-text8" for="price-input">Price</label>
                  <div class="et-input-row-2">
                    <input
                      class="ec-input-field"
                      id="price-input"
                      name="price"
                      type="number"
                      min="0"
                      placeholder="Enter price"
                      autocomplete="off"
                      style="font-family:'Instrument Sans',sans-serif;"
                    />
                    <div class="et-input-info">
<!--                      <img src="/static/images/sidebar/CalendarBlank.svg" class="et-input-calendar" alt="calendar"/>-->
                    </div>
                  </div>
                </div>
              </div>

              <div class="et-column10">
                <div class="et-view2">
                  <div class="et-row-view12">
                    <label class="ec-styled-checkbox">
                      <input type="checkbox" name="free_entrance" id="free-entrance-checkbox">
                      <span class="checkmark"></span>
                      <span class="checkbox-label ec-text10">Free entrance</span>
                    </label>
                  </div>
                </div>


            </div>

          </div>

          <div class="et-form-actions">
            <div class="et-progress-indicator">
              <span class="et-step-text">3 of 3</span>
            </div>
            <div class="et-button-row">
              <button class="btn btn-accent" type="button" onclick="window.location.href='/admin/events/cancel'">Cancel</button>
              <button class="btn btn-next-step">Next</button>
            </div>
          </div>

        </div>
      </div>
    </form>
  </div>

  <div id="event-success-modal" class="et-modal-overlay" style="display: none;">
    <div class="et-modal-content">
      <div class="et-modal-icon">
        <svg width="49" height="48" viewBox="0 0 49 48" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect x="0.5" width="48" height="48" rx="9" fill="#F7F7F7"/>
        <path d="M33.7924 15.4364L21.5012 28.0486L15.195 21.5781C15.0659 21.4444 14.9123 21.3382 14.7431 21.2655C14.5738 21.1929 14.3923 21.1553 14.2088 21.1549C14.0254 21.1544 13.8436 21.1912 13.6741 21.263C13.5045 21.3348 13.3504 21.4403 13.2207 21.5734C13.0909 21.7065 12.9881 21.8646 12.918 22.0386C12.848 22.2126 12.8121 22.399 12.8125 22.5873C12.8129 22.7755 12.8495 22.9618 12.9202 23.1355C12.991 23.3092 13.0944 23.4669 13.2247 23.5994L20.516 31.0809C20.7879 31.3605 21.1445 31.5 21.5012 31.5C21.8578 31.5 22.2144 31.3605 22.4863 31.0809L35.7622 17.4577C35.8953 17.3259 36.0014 17.1681 36.0744 16.9937C36.1474 16.8193 36.1858 16.6317 36.1874 16.4419C36.1891 16.2521 36.1538 16.0639 36.0838 15.8882C36.0137 15.7125 35.9103 15.5529 35.7795 15.4187C35.6487 15.2845 35.4931 15.1783 35.3219 15.1065C35.1507 15.0346 34.9673 14.9984 34.7823 15.0001C34.5974 15.0017 34.4146 15.0411 34.2446 15.1161C34.0747 15.191 33.9209 15.2999 33.7924 15.4364Z" fill="black"/>
        </svg>
      </div>
      <div class="et-modal-title">Event successfully saved</div>
      <div class="et-modal-desc">
        Your event was successfully created as a draft<br>
        You can edit and publish it anytime from the<br>
        <b>Unpublished</b> events section.
      </div>
      <button class="btn button-publish" onclick="window.location.href='/admin/events'">Go to event list</button>
    </div>
  </div>

  <div id="event-error-modal" class="et-modal-overlay" style="display: none;">
    <div class="et-modal-content">
      <div class="et-modal-icon">
        <!-- Иконка-ошибка SVG (крестик в круге) -->
        <svg width="48" height="48" fill="none">
          <rect width="48" height="48" rx="9" fill="#F7F7F7"/>
          <path d="M16 16l16 16M32 16l-16 16" stroke="#D33A3A" stroke-width="3" stroke-linecap="round"/>
        </svg>
      </div>
      <div class="et-modal-title" style="color: #D33A3A;">Event not saved</div>
      <div class="et-modal-desc">
        Something went wrong while saving your event.<br>
        Please try again.<br>
        If the problem persists, contact support.
      </div>
      <button class="et-modal-btn-error" onclick="hideErrorModal()">Close</button>
    </div>
  </div>

</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  const input = document.getElementById('date-input');
  if (input) {
    input.addEventListener('focus', function() { this.placeholder = 'ДД.ММ.ГГГГ'; });
    input.addEventListener('blur', function() { if (!this.value) this.placeholder = 'Select date'; });
  }

  function updateCharCount(input, counterSelector, max) {
    const val = input.value.length;
    const el = document.querySelector(counterSelector);
    if (el) el.textContent = `${val}/${max} characters`;
  }
</script>



<script>
  document.addEventListener('DOMContentLoaded', function() {
    const freeEntranceCheckbox = document.getElementById('free-entrance-checkbox');
    const priceInput = document.getElementById('price-input');

    if (freeEntranceCheckbox && priceInput) {
      freeEntranceCheckbox.addEventListener('change', function() {
        if (this.checked) {
          priceInput.value = 0;
          priceInput.setAttribute('readonly', 'readonly');
        } else {
          priceInput.removeAttribute('readonly');
          priceInput.value = '';
        }
      });
    }
  });

  function hideErrorModal() {
    document.getElementById('event-error-modal').style.display = 'none';
  }
</script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    {% if show_modal == True %}
      document.getElementById('event-success-modal').style.display = 'flex';
    {% elif show_modal == 'error' %}
      document.getElementById('event-error-modal').style.display = 'flex';
    {% endif %}
  });
</script>

</html>
